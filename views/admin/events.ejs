<!DOCTYPE html>
<html lang="en">
	<%- include('../partials/head.ejs') %>

	<body>
		
		<div id="site-content">
			<%- include('../partials/header_admin.ejs') %>
            
            <main class="main-content">
				<div class="fullwidth-block gallery">
					<div class="container">
						<div class="content fullwidth">
							<h2 class="entry-title">Events</h2>
							<div class="filter-links filterable-nav">
								<select class="mobile-filter">
										<option value=".2023" selected>2023</option>
										<option value=".2024">2024</option>
										<option value=".2025">2025</option>
									</select>
								<a href="#" class="current" data-filter=".2023">2023</a>
								<a href="#" data-filter=".2024">2024</a>
								<a href="#" data-filter=".2025">2025</a>
							</div>
                            <a href="/add-event" class="button">Dodaj Dogadjaj</a>
							<div class="filterable-items">
								<% months.forEach(month => { %>
                                    <% const year = 2023; %>
                                    <% const filteredEvents = events.filter(event => event.date.getMonth() === months.indexOf(month) && event.year == year); %>
                                    <% if (filteredEvents.length > 0) { %>
										<div class="filterable-item <%= year %>">
											<table class="event-table" style="width: auto;  white-space: nowrap;">
												<tr style="background-color: #333;">
													<th colspan="5" style="text-align: center; border: 1px solid #555; color: white; font-weight: bold;">
														<%= month %>
													</th>
												</tr>
												<% filteredEvents.forEach(event => { %>
													<tr>
														<td style="color: white;">
															<%= event.event %>
														</td>
														<td style="color: #aaa;">
															<%= event.location %>
														</td>
														<td style="color: #aaa;">
															<%= event.place %>
														</td>
														<td style="color: #aaa;">
															<%= event.date.toLocaleDateString('en-GB') %>
														</td>
														<td style="color: #aaa;">
															<!-- Add options for edit and delete here -->
															<a href="/edit-event/<%= event.id %>">Uredi</a>
															<form action="/delete-event/<%= event._id %>?_method=DELETE" method="POST">
																<input type="submit" value="Obrisi" class="button" >
															</form>
														</td>
													</tr>
												<% }) %>
											</table>
										</div>
                                    <% } %>
								<% }) %>                                
								<% months.forEach(month => { %>
                                    <% const year = 2024; %>
                                    <% const filteredEvents = events.filter(event => event.date.getMonth() === months.indexOf(month) && event.year == year); %>
                                    <% if (filteredEvents.length > 0) { %>
										<div class="filterable-item <%= year %>" style="width: calc(50% - 10px); padding: 20px;">
											<table class="event-table" style="border-color: white; background-color: #222; border-collapse: collapse; height: 100%;">
												<tr style="background-color: #333;">
													<th colspan="5" style="padding: 10px; text-align: center; border: 1px solid #555; color: white; font-weight: bold;">
													<%= month %>
													</th>
												</tr>
												<% filteredEvents.forEach(event => { %>
													<tr>
														<td style="padding: 10px; border: 1px solid #555; color: white;">
															<%= event.event %>
														</td>
														<td style="padding: 10px; border: 1px solid #555; color: #aaa;">
															<%= event.location %>
														</td>
														<td style="padding: 10px; border: 1px solid #555; color: #aaa;">
															<%= event.place %>
														</td>
														<td style="padding: 10px; border: 1px solid #555; color: #aaa;">
															<%= event.date.toLocaleDateString('en-GB') %>
														</td>
														<td style="padding: 10px; border: 1px solid #555; color: #aaa;">
															<!-- Add options for edit and delete here -->
															<a href="/edit-event/<%= event.id %>">Uredi</a>
															<form action="/delete-event/<%= event._id %>?_method=DELETE" method="POST">
																<input type="submit" value="Obrisi" class="button" >
															</form>
														</td>
													</tr>
												<% }) %>
											</table>
										</div>
                                    <% } %>
								<% }) %>   
								<% months.forEach(month => { %>
                                    <% const year = 2025; %>
                                    <% const filteredEvents = events.filter(event => event.date.getMonth() === months.indexOf(month) && event.year == year); %>
                                    <% if (filteredEvents.length > 0) { %>
										<div class="filterable-item <%= year %>" style="width: calc(50% - 10px); padding: 20px;">
											<table class="event-table" style="border-color: white; background-color: #222; border-collapse: collapse; height: 100%;">
												<tr style="background-color: #333;">
													<th colspan="5" style="padding: 10px; text-align: center; border: 1px solid #555; color: white; font-weight: bold;">
													<%= month %>
													</th>
												</tr>
												<% filteredEvents.forEach(event => { %>
													<tr>
														<td style="padding: 10px; border: 1px solid #555; color: white;">
															<%= event.event %>
														</td>
														<td style="padding: 10px; border: 1px solid #555; color: #aaa;">
															<%= event.location %>
														</td>
														<td style="padding: 10px; border: 1px solid #555; color: #aaa;">
															<%= event.place %>
														</td>
														<td style="padding: 10px; border: 1px solid #555; color: #aaa;">
															<%= event.date.toLocaleDateString('en-GB') %>
														</td>
														<td style="padding: 10px; border: 1px solid #555; color: #aaa;">
															<!-- Add options for edit and delete here -->
															<a href="/edit-event/<%= event.id %>">Uredi</a>
															<form action="/delete-event/<%= event._id %>?_method=DELETE" method="POST">
																<input type="submit" value="Obrisi" class="button" >
															</form>
														</td>
													</tr>
												<% }) %>
											</table>
										</div>
                                    <% } %>
                                  <% }) %>   
							</div>
						</div>
					</div>
				</div> <!-- .testimonial-section -->
			</main> <!-- .main-content -->
            <%- include('../partials/footer.ejs') %>
            
		</div> <!-- #site-content -->

		<script src="/js/jquery-1.11.1.min.js"></script>		
		<script src="/js/plugins.js"></script>
		<script src="/js/app.js"></script>
		
		
	</body>

</html>
